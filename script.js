// Complete product data with descriptions including material type and thickness
const products = [


  // Sngle Stones 
  {
    name: "Agra Red",
    image: "images/Single-Agra-Red.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Chocolate",
    image: "images/Single-Chocolate.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },


  {
    name: "Bhanslana Split Face",
    image: "images/Bhanslana Split Face.jpg",
    description: "Material: Slatestone | Thickness: 18-25mm"
  },
  {
    name: "Black Monsoon",
    image: "images/Black-Moonsoon.jpg",
    description: "Material: Slatestone | Thickness: 18-25mm"
  },
  {
    name: "Black Slate",
    image: "images/Black-Slate-Wall-Cladding.jpg",
    description: "Material: Slatestone | Thickness: 18-25mm"
  },

  {
    name: "Copper",
    image: "images/Copper.jpg",
    description: "Material: Slatestone | Thickness: 18-25mm"
  },
  {
    name: "Garda Buff",
    image: "images/Garda Buff.jpg",
    description: "Material: Limestone | Thickness: 18-25mm"
  },
  {
    name: "Garda Buff Coated",
    image: "images/Garda Buff Coat.jpg",
    description: "Material: Limestone | Thickness: 18-25mm"
  },
  {
    name: "Golden State",
    image: "images/Golden-Slate.jpg",
    description: "Material: Slatestone | Thickness: 18-25mm"
  },
  {
    name: "Jak Black",
    image: "images/Jak-Black.jpg",
    description: "Material: Sandstone | Thickness: 20-30mm | Finish: Natural | Deep black stone with subtle grain patterns."
  },
  {
    name: "Jak Black Coated",
    image: "images/Jak-Black-Coat.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Jak Multi",
    image: "images/Jak-Multi.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Kandala Grey",
    image: "images/Kandala-Grey.jpg",
    description: "Material: Sandstone | Thickness: 20-30mm"
  },
  {
    name: "Kandala Grey Coated",
    image: "images/Kandala-Grey-Coat.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Kandala Grey",
    image: "images/Kandla-Grey-Wall.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Kandala Grey",
    image: "images/Kandla-Grey-Wall-Cladding.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Mint Stone",
    image: "images/Mint-Stone.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Mint Stone Coated",
    image: "images/Mint-Stone-Coat.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Modak",
    image: "images/Modak.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Oriental Gold",
    image: "images/Oriental Gold.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Oriental White",
    image: "images/Oriental White.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Rajgreen",
    image: "images/Rajgreen.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Rajgreen Coated",
    image: "images/Rajgreen-Coat.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Sagar Black",
    image: "images/Sagar-Black.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Sagar Black",
    image: "images/Sagar-Black-Sandstone.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Silver Grey",
    image: "images/Silver-Grey.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Silver Shine",
    image: "images/Silver-Shine.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Autumn Brown",
    image: "images/Single-Autumn-Brown.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },

  {
    name: "Deoli Green",
    image: "images/Single-Deoli-Green.jpg",
    description: "Material: Slatestone | Thickness: 18-25mm"
  },
  {
    name: "Kandala Grey",
    image: "images/Single-Kanadala-Grey.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Kandala Grey Smooth Honed",
    image: "images/Single-KG-Smooth-Honed.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Kandala Grey Smooth Honed",
    image: "images/Single-KG-Smooth-Honed-2.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Kundmulti",
    image: "images/Single-Kundmulti.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Lalitpur Grey",
    image: "images/Single-Latipur-Grey.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Lalitpur Yellow",
    image: "images/Single-Latipur-Yellow.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Mandana",
    image: "images/Single-Mandana.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Mint Ivory",

    image: "images/Mint-ivory-Sandstone.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Mint",
    image: "images/Single-Mint-Natural.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Modak",
    image: "images/Single-Modak.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Rainbow",
    image: "images/Single-Rainbow.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Raj Green",
    image: "images/Single-Raj-Green.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Red",
    image: "images/Single-Red-Natural.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Sagar Black",
    image: "images/Single-Sagar-Black.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Silver Grey",
    image: "images/Single-Silver-Grey.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Teak",
    image: "images/Single-Teak.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Teak Wood",
    image: "images/Teak-Wood.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Teak Wood Coated",
    image: "images/Teak-Wood-Coat.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Zeera Green",
    image: "images/Zeera-Green.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Agra Red",
    image: "images/New/Agra-Red-Natural.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Agra Red",
    image: "images/New/Agra-Red-Pattern.webp",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Agra Red",
    image: "images/New/Agra-Red-Pattern-Natural.png",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Dholpur Beige",
    image: "images/New/Dholpur-Beidge-Natural.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Kandala Grey",
    image: "images/New/Kandala-Grey-Natural-Sandstone.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Kandala Grey",
    image: "images/New/Kanadala-Grey-New.png",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Lalitpur",
    image: "images/New/Lalitpur-Natural.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  {
    name: "Mandana",
    image: "images/New/Mandana-Natural-Sandstone.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  ,
  {
    name: "Mint White",
    image: "images/New/Mint-White-Natural.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  ,
  {
    name: "Rainbow",
    image: "images/New/Rainbow-Sandstone.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },

  {
    name: "Rajgreen",
    image: "images/New/Rajgreen-Natural.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },
  ,

  {
    name: "Teak Wood",
    image: "images/New/Teak-Wood-Polished.jpg",
    description: "Material: Sandstone | Thickness: 25-30mm"
  },


];


// 3D Perspective Variables
let isDragging = false;
let startX, startY;
let rotationX = 0;
let rotationY = 0;
let currentScale = 1;
let touchId = null;
let initialDistance = 0;

function displayProducts(filter = '') {
  const container = document.getElementById('products-container');
  container.innerHTML = '';

  const filteredProducts = filter
    ? products.filter(p =>
      p.name.toLowerCase().includes(filter.toLowerCase()) ||
      p.description.toLowerCase().includes(filter.toLowerCase())
    )
    : products;

  if (filteredProducts.length === 0) {
    container.innerHTML = '<p style="grid-column:1/-1;text-align:center;color:#666;font-size:13px;">No products found</p>';
    return;
  }

  filteredProducts.forEach(product => {
    const card = document.createElement('div');
    card.className = 'product-card';
    card.innerHTML = `
      <div class="product-image">
        <img src="${product.image}" alt="${product.name}" loading="lazy">
      </div>
      <div class="product-info">
        <h3 class="product-name">${product.name}</h3>
        <p class="product-description">${product.description.split('|').slice(0, 2).join('|')}</p>
      </div>
    `;
    card.addEventListener('click', () => openModal(product));
    container.appendChild(card);
  });
}

function openModal(product) {
  const modal = document.getElementById('imageModal');
  const modalImg = document.getElementById('modalImage');

  modalImg.src = product.image;
  modalImg.alt = product.name;
  document.getElementById('modalTitle').textContent = product.name;
  document.getElementById('modalDescription').innerHTML =
    product.description.split('|').map(p => `<p>• ${p.trim()}</p>`).join('');

  rotationX = 0;
  rotationY = 0;
  currentScale = 1;
  updateImageTransform();

  modal.style.display = "block";
}

function updateImageTransform() {
  const img = document.getElementById('modalImage');
  img.style.transform = `
    perspective(1500px)
    rotateX(${rotationX}deg)
    rotateY(${rotationY}deg)
    scale(${currentScale})
  `;
}

function initControls() {
  const container = document.querySelector('.modal-image-container');
  const img = document.getElementById('modalImage');

  container.addEventListener('mousedown', (e) => {
    isDragging = true;
    startX = e.clientX;
    startY = e.clientY;
    container.classList.add('grabbing');
    e.preventDefault();
  });

  document.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    const deltaX = e.clientX - startX;
    const deltaY = e.clientY - startY;
    rotationY = deltaX * 0.2;
    rotationX = -deltaY * 0.2;
    updateImageTransform();
    e.preventDefault();
  });

  document.addEventListener('mouseup', () => {
    isDragging = false;
    container.classList.remove('grabbing');
  });

  container.addEventListener('touchstart', (e) => {
    if (e.touches.length === 1) {
      const touch = e.touches[0];
      isDragging = true;
      touchId = touch.identifier;
      startX = touch.clientX;
      startY = touch.clientY;
      container.classList.add('grabbing');
      e.preventDefault();
    } else if (e.touches.length === 2) {
      initialDistance = Math.hypot(
        e.touches[0].clientX - e.touches[1].clientX,
        e.touches[0].clientY - e.touches[1].clientY
      );
      e.preventDefault();
    }
  }, { passive: false });

  document.addEventListener('touchmove', (e) => {
    if (e.touches.length === 1 && isDragging) {
      const touch = Array.from(e.touches).find(t => t.identifier === touchId);
      if (!touch) return;
      const deltaX = touch.clientX - startX;
      const deltaY = touch.clientY - startY;
      rotationY = deltaX * 0.3;
      rotationX = -deltaY * 0.3;
      updateImageTransform();
      e.preventDefault();
    } else if (e.touches.length === 2 && initialDistance > 0) {
      const currentDistance = Math.hypot(
        e.touches[0].clientX - e.touches[1].clientX,
        e.touches[0].clientY - e.touches[1].clientY
      );
      const scaleFactor = currentDistance / initialDistance;
      currentScale = Math.max(0.5, Math.min(3, currentScale * scaleFactor));
      updateImageTransform();
      initialDistance = currentDistance;
      e.preventDefault();
    }
  }, { passive: false });

  document.addEventListener('touchend', (e) => {
    if (e.touches.length === 0) {
      isDragging = false;
      container.classList.remove('grabbing');
      initialDistance = 0;
    } else if (e.touches.length === 1) {
      const remainingTouch = Array.from(e.touches).find(t => t.identifier === touchId);
      if (!remainingTouch) {
        isDragging = false;
        container.classList.remove('grabbing');
      }
    }
  });
}

// Zoom buttons
document.getElementById('zoom-in').addEventListener('click', () => {
  currentScale = Math.min(3, currentScale + 0.2);
  updateImageTransform();
});
document.getElementById('zoom-out').addEventListener('click', () => {
  currentScale = Math.max(0.5, currentScale - 0.2);
  updateImageTransform();
});
document.getElementById('zoom-reset').addEventListener('click', () => {
  currentScale = 1;
  rotationX = 0;
  rotationY = 0;
  updateImageTransform();
});
['zoom-in', 'zoom-out', 'zoom-reset'].forEach(id => {
  const btn = document.getElementById(id);
  btn.addEventListener('touchstart', (e) => {
    e.preventDefault();
    btn.click();
  }, { passive: false });
});

// Close modal
document.querySelector('.close').addEventListener('click', () => {
  document.getElementById('imageModal').style.display = "none";
});
window.addEventListener('click', (e) => {
  if (e.target === document.getElementById('imageModal')) {
    document.getElementById('imageModal').style.display = "none";
  }
});
document.querySelector('.close').addEventListener('touchstart', (e) => {
  e.preventDefault();
  document.querySelector('.close').click();
}, { passive: false });

// Search functionality
document.getElementById('search-input').addEventListener('input', function () {
  displayProducts(this.value);
});

// INITIALIZE and SORT alphabetically before display
document.addEventListener('DOMContentLoaded', () => {
  // Sort products A–Z by name
  products.sort((a, b) => a.name.localeCompare(b.name));
  displayProducts();
  initControls();

  // Enable zoom with mouse wheel
  const modalImg = document.getElementById('modalImage');
  modalImg.addEventListener('wheel', (e) => {
    e.preventDefault();
    currentScale = e.deltaY < 0
      ? Math.min(3, currentScale + 0.1)
      : Math.max(0.5, currentScale - 0.1);
    updateImageTransform();
  }, { passive: false });
});

// // tool tip
// Toggle tooltip on mobile click
document.querySelectorAll('.tooltip').forEach(el => {
  el.addEventListener('click', function () {
    document.querySelectorAll('.tooltip').forEach(t => {
      if (t !== el) t.classList.remove('active');
    });
    el.classList.toggle('active');
  });
});

//   // Show tooltip on mobile click
//   document.querySelectorAll('.tooltip').forEach(el => {
//     el.addEventListener('click', function () {
//       // Close other tooltips
//       document.querySelectorAll('.tooltip').forEach(tip => {
//         if (tip !== el) tip.classList.remove('active');
//       });
//       // Toggle current
//       el.classList.toggle('active');
//     });
//   });

//   // Add active tooltip styling
//   const style = document.createElement('style');
//   style.innerHTML = `
//     .tooltip.active::after,
//     .tooltip.active::before {
//       opacity: 1 !important;
//       visibility: visible !important;
//     }
//   `;
//   document.head.appendChild(style);
